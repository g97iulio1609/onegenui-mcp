{"version":3,"sources":["../src/registry/env-resolver.ts"],"sourcesContent":["import type { McpServerConfig } from \"../types\";\n\n/**\n * Resolve environment variables in a string.\n * Supports ${VAR_NAME} syntax.\n */\nexport function resolveEnvVars(value: string): string {\n  return value.replace(/\\$\\{([^}]+)\\}/g, (_, varName) => {\n    return process.env[varName] ?? \"\";\n  });\n}\n\n/**\n * Resolve environment variables in server config.\n */\nexport function resolveServerEnv(config: McpServerConfig): McpServerConfig {\n  if (config.transport === \"stdio\") {\n    const resolvedEnv: Record<string, string> = {};\n\n    if (config.env) {\n      for (const [key, value] of Object.entries(config.env)) {\n        resolvedEnv[key] = resolveEnvVars(value);\n      }\n    }\n\n    return {\n      ...config,\n      command: resolveEnvVars(config.command),\n      args: config.args?.map(resolveEnvVars),\n      env: Object.keys(resolvedEnv).length > 0 ? resolvedEnv : undefined,\n    };\n  }\n\n  if (config.transport === \"http\") {\n    const resolvedHeaders: Record<string, string> = {};\n\n    if (config.headers) {\n      for (const [key, value] of Object.entries(config.headers)) {\n        resolvedHeaders[key] = resolveEnvVars(value);\n      }\n    }\n\n    return {\n      ...config,\n      url: resolveEnvVars(config.url),\n      headers:\n        Object.keys(resolvedHeaders).length > 0 ? resolvedHeaders : undefined,\n    };\n  }\n\n  if (config.transport === \"local\") {\n    return {\n      ...config,\n      module: resolveEnvVars(config.module),\n      toolsetExport: config.toolsetExport\n        ? resolveEnvVars(config.toolsetExport)\n        : undefined,\n    };\n  }\n\n  return config;\n}\n"],"mappings":";AAMO,SAAS,eAAe,OAAuB;AACpD,SAAO,MAAM,QAAQ,kBAAkB,CAAC,GAAG,YAAY;AACrD,WAAO,QAAQ,IAAI,OAAO,KAAK;AAAA,EACjC,CAAC;AACH;AAKO,SAAS,iBAAiB,QAA0C;AACzE,MAAI,OAAO,cAAc,SAAS;AAChC,UAAM,cAAsC,CAAC;AAE7C,QAAI,OAAO,KAAK;AACd,iBAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,OAAO,GAAG,GAAG;AACrD,oBAAY,GAAG,IAAI,eAAe,KAAK;AAAA,MACzC;AAAA,IACF;AAEA,WAAO;AAAA,MACL,GAAG;AAAA,MACH,SAAS,eAAe,OAAO,OAAO;AAAA,MACtC,MAAM,OAAO,MAAM,IAAI,cAAc;AAAA,MACrC,KAAK,OAAO,KAAK,WAAW,EAAE,SAAS,IAAI,cAAc;AAAA,IAC3D;AAAA,EACF;AAEA,MAAI,OAAO,cAAc,QAAQ;AAC/B,UAAM,kBAA0C,CAAC;AAEjD,QAAI,OAAO,SAAS;AAClB,iBAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,OAAO,OAAO,GAAG;AACzD,wBAAgB,GAAG,IAAI,eAAe,KAAK;AAAA,MAC7C;AAAA,IACF;AAEA,WAAO;AAAA,MACL,GAAG;AAAA,MACH,KAAK,eAAe,OAAO,GAAG;AAAA,MAC9B,SACE,OAAO,KAAK,eAAe,EAAE,SAAS,IAAI,kBAAkB;AAAA,IAChE;AAAA,EACF;AAEA,MAAI,OAAO,cAAc,SAAS;AAChC,WAAO;AAAA,MACL,GAAG;AAAA,MACH,QAAQ,eAAe,OAAO,MAAM;AAAA,MACpC,eAAe,OAAO,gBAClB,eAAe,OAAO,aAAa,IACnC;AAAA,IACN;AAAA,EACF;AAEA,SAAO;AACT;","names":[]}